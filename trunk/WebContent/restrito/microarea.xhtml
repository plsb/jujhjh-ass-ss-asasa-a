<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:sec="http://www.springframework.org/security/facelets/tags"
	xmlns:p="http://primefaces.org/ui"
	xmlns:rich="http://richfaces.org/rich"
    xmlns:a4j = "http://richfaces.org/a4j">




<ui:composition template="/templates/interna.xhtml">

	<ui:define name="titulo">
    Inserção/Edição de Microáreas
    </ui:define>



	<ui:define name="corpo">
	
	<h:form id="cadastro">
 
			<h:messages />
			<p:growl id="msg" showDetail="true" escape="false" /> 
			
			<h:inputHidden value="#{microareaBean.microarea.codigo_microarea}"/>
			
			<h:panelGrid columns="1">
				<h:outputLabel value="Descrição:" for="descricao" />
				<h:inputText id="descricao" label="descricao" size="30"
					 maxlength="50" required="true" value="#{microareaBean.microarea.descricao}"
					requiredMessage="Não foi informado a Descrição.">
				</h:inputText>		
				<h:outputLabel value="Área: " for="area"/>
				<h:selectOneMenu id="area" value="#{microareaBean.microarea.area}">
					<f:selectItems  value="#{areaBean.areaSelect}"/>					 			
				</h:selectOneMenu> 		 
				<h:outputLabel value="Agente Responsável: " for="agente"/>
				<h:selectOneMenu id="agente" value="#{microareaBean.microarea.agente}">
					<f:selectItems  value="#{usuarioBean.agenteSelect}"/>					 			
				</h:selectOneMenu> 		

            	<p:panel header="Ruas Associadas a Essa Microárea" toggleable="true" id="panel" rendered="#{microareaBean.mostraInsereRuas}">  
				        <h:panelGrid columns="3" cellpadding="5">   
			            	<h:outputLabel value="Pesquise a Rua: " for="rua"/>
			            	<p:autoComplete id="acDelay" queryDelay="500"  
				                    	completeMethod="#{microareaBean.complete}" effect="blind"/>  
				        	
				       		<h:commandButton action="#" value="Inserir Rua"/>
				       	</h:panelGrid>
				       	
				       	<p:dataTable id="tbl" var="rua" value="#{microareaBean.microarea.ruasLista}" paginator="true" rows="10">  
			
					    <p:column>  
					        <f:facet name="header">  
					            <h:outputText value="Rua" />  
					        </f:facet>  
					        <h:outputText value="#{rua.descricao}" />  
					    </p:column>  
					    
					    <p:column>
							<sec:ifAnyGranted roles="ROLE_USU_WEB">
							<h:commandLink action="#{ruaBean.excluir}" onclick="if (!confirm('Confirma a exclusão da Rua ?')) return false;" title="Excluir Rua">
								<h:graphicImage library="imagens" name="excluir16.png" style="border:0"/>
								<f:setPropertyActionListener target="#{ruaBean.rua}" value="#{rua}"/>
							</h:commandLink>
							</sec:ifAnyGranted>
						</p:column>
			   
				</p:dataTable>  
	   		</p:panel>	
		</h:panelGrid>
			
		
			<h:commandButton action="#{microareaBean.salvar}" value="Salvar"/>
			
		</h:form>
		<h:form>
			<h:commandLink action="/restrito/lista_microarea"  onclick="if (!confirm('Deseja Sair desta Página e Cancelar a Inserção de Microárea?')) return false;" title="Voltar">
							<h:graphicImage library="imagens" name="voltar.png" />
			</h:commandLink>
		</h:form>		
		
	</ui:define>
</ui:composition>
<rich:modalPanel id="mp" width="350" height="100">
        <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Modal Panel"></h:outputText>
            </h:panelGroup>
        </f:facet>
        <f:facet name="controls">
            <h:panelGroup>
               <!--  <h:graphicImage value="/images/modal/close.png" styleClass="hidelink" id="hidelink"/>  -->
                <rich:componentControl for="panel" attachTo="hidelink" operation="hide" event="onclick"/>
            </h:panelGroup>
        </f:facet>
        <h:outputText value="This panel is called using Component Control Component"></h:outputText>
        <br/>
        <h:outputText value="Closure link (X) works also through Component Control"></h:outputText>
    </rich:modalPanel>
</html>